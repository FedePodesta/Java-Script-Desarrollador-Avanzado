
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clase 12 - Promise</title>
</head>
<body>
    
    <script>
        // const p = new Promise((resolve, reject) => {
        //     // resolve('valor'); // se resuelve con un valor
        //     // reject('error'); // la razon del rechazo

        //     // setTimeout(() => {
        //     //     reject([1, 3, 4, 5]);
        //     // }, 3000);

        //     const xhr = new XMLHttpRequest();

        //     xhr.open('get', 'https://jsonplaceholder.typicode.com/users');

        //     xhr.responseType = 'json';

        //     xhr.addEventListener('load', e => {
        //         if (xhr.status >= 200 && xhr.status <= 299) {
        //             console.log('LOAD');
        //             resolve(xhr.response);
        //             // reject('Error Load');
        //         } else {
        //             console.log('LOAD ERROR');
        //             reject(`Error: ${xhr.status}`);
        //         }
        //     });

        //     xhr.addEventListener('error', e => {
        //         console.log('ERROR');
        //         reject('Error');
        //     });

        //     xhr.send();
        // });

        // p
        //     .then(datos => {
        //         console.log('THEN');
        //         console.log('datos', datos);
        //     })
        //     .catch(error => {
        //         console.log('CATCH');
        //         console.error('Error: ', error);
        //     })
        //     .finally(() => {
        //         console.log('FIN');
        //     });

        // fetch('https://jsonplaceholder.typicode.com/users')
        //     .then(res => {
        //         console.log('then fetch');
        //         if (res.ok) {
        //             console.log('Puedo mostrar los usuarios')
        //             return res.json();
        //         } else {
        //             console.log('Mostrar error')
        //             // throw new Error('No pude obtener los usuarios');
        //             return Promise.reject('No pude obtener los usuarios');
        //         }
        //     })
        //     .then(usuarios => {
        //         console.log('then usuarios')
        //         console.log('usuarios', usuarios);
        //     })
        //     .catch(error => {
        //         console.log('catch');
        //         console.error('Error: ', error);
        //     });



        fetch('https://jsonplaceholder.typicode.com/users/10')
            .then(res => res.json())
            .then(usuario => {  
                if (usuario.id !== undefined) {
                    console.log('tengo el usuario', usuario);
                } else {
                    console.log('Error');
                }
            })
            .catch(error => {
                console.error('Error: ', error);
            });

        // const getUsuarios = new Promise((resolve, reject) => {
        //     setTimeout(() => {
        //         resolve([{id: 10, nombre: 'Nombre'}])
        //     }, 3000);
        // })

        // getUsuarios
        //     .then(usuarios => {
        //         console.log('usuarios', usuarios);

        //         return new Promise((resolve, reject) => {
        //             setTimeout(() => {
        //                 resolve({
        //                     id: 1,
        //                     nombre: 'Nombre',
        //                     tel: 412313123,
        //                     url: 'https://www.google.com'
        //                 })
        //             }, 3000)
        //         })
        //     })
        //     .then(usuario => {
        //         console.log('usuario', usuario)
        //     })
        //     .catch(e => console.error(e));


        fetch('https://jsonplaceholder.typicode.com/users', {
            method: 'post',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                nombre: 'asdasd',
                apellido: 'qweqweqwe'
            })
        })

        fetch('https://jsonplaceholder.typicode.com/users/1', {
            method: 'put',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                nombre: 'asdasd',
                apellido: 'qweqweqwe'
            })
        })
    </script>
</body>
</html>